# Identifying Memorization of Diffusion Models through *p*-Laplace Analysis  
Official implementation of Brokman et. al, SSVM 2025.

## Overview

This repository provides the official code and experiments accompanying the paper:  
**“Identifying Memorization of Diffusion Models through *p*-Laplace Analysis”** (SSVM 2025)

We include two main experiments:
1. A 2D Gaussian Mixture Model (GMM) experiment with a small diffusion model.
2. An image experiment using a pre-trained Stable Diffusion v1.4 model.

The core *p*-Laplace functionalities are in **`p_laplace_core.py`**, and the scripts assume the original directory structure.

---

## Installation

**Dependencies** (Python 3.9+ recommended):
```
numpy
torch
diffusers
transformers
Pillow
matplotlib
torchvision
```

---

## Usage

### 1. Gaussian Mixture Model Data Experiment
In this experiment we train a simple diffusion model on a GMM dataset and demonstrate *p*-Laplace analysis on the resulting model.  
command:
```
python script_gmm_score_function.py
```

---

### 2. Real Images with Stable Diffusion 1.4
This experiment demonstrates how to perform *p*-Laplace analysis on a pre-trained stable-diffusion model, and applies it to memorized and non-memorized images generated by a pre-trained [SD v1.4](https://huggingface.co/CompVis/stable-diffusion-v1-4).  

1) Generate images with `stable_diffusion_generate.py` (memorized vs. non-memorized).  
2) Run `script_hippo_memorized.py` to apply *p*-Laplace analysis.

command:
```
python stable_diffusion_generate.py
python script_hippo_memorized.py
```

---

## Citation

If you find our or work helpful, please cite our paper:

```
@article{brokman2025identifying,
  title={Identifying Memorization of Diffusion Models through p-Laplace Analysis},
  author={Brokman, Jonathan and Giloni, Amit and Hofman, Omer and Vainshtein, Roman and Kojima, Hisashi and Gilboa, Guy},
  journal={arXiv preprint, accepted for the 10th International Conference on Scale Space and Variational Methods in Computer Vision. arXiv:2505.08246},
  year={2025}
}
```
