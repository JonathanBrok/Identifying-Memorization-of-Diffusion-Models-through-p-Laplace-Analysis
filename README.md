# Identifying Memorization of Diffusion Models through *p*-Laplace Analysis  
Official implementation for **SSVM 2025**

## Overview

This repository provides the official code and experiments accompanying the paper:  
**“Identifying Memorization of Diffusion Models through *p*-Laplace Analysis”** (SSVM 2025)

We include two main experiments:
1. A 2D Gaussian Mixture Model (GMM) experiment with a small diffusion model.
2. An image experiment using a pre-trained Stable Diffusion v1.4 model.

The core *p*-Laplace functionalities are in **`p_laplace_core.py`**, and the scripts assume the original directory structure.

---

## Installation

**Dependencies** (Python 3.9+ recommended):
```
numpy
torch
diffusers
transformers
Pillow
matplotlib
torchvision
```

---

## Usage

### 1. Gaussian Mixture Model Data Experiment
In this experiment we train a simple diffusion model on a GMM dataset and demonstrate *p*-Laplace analysis on the resulting model.  
command:
```
python script_gmm_score_function.py
```

*(Insert figure or result PNG here)*

---

### 2. Real Images with Stable Diffusion 1.4
This experiment demonstrates how to perform *p*-Laplace analysis on a pre-trained stable-diffusion model, and applies it to memorized and non-memorized images generated by a pre-trained [SD v1.4](https://huggingface.co/CompVis/stable-diffusion-v1-4).  

1) Generate images with `stable_diffusion_generate.py` (memorized vs. non-memorized).  
2) Run `script_hippo_memorized.py` to apply *p*-Laplace analysis.

command:
```
python stable_diffusion_generate.py
python script_hippo_memorized.py
```

*(Insert figure or result PNG here)*

---

## Citation

If you find our or work helpful, please cite our paper (while we await SSVM publication, the reference below is applicable as well - where we include a similar 1-Laplace analysis):

```
@inproceedings{
brokman2025manifold,
title={Manifold Induced Biases for Zero-shot and Few-shot Detection of Generated Images},
author={Jonathan Brokman and Amit Giloni and Omer Hofman and Roman Vainshtein and Hisashi Kojima and Guy Gilboa},
booktitle={The Thirteenth International Conference on Learning Representations},
year={2025},
url={https://openreview.net/forum?id=7gGl6HB5Zd}
}
```
